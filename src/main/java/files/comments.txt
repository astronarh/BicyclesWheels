import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.sql.*;
import java.util.Calendar;

public class LoadFile {
    private static String createTable = "CREATE TABLE IF NOT EXISTS bicycles (" +
            "id integer primary key auto_increment, " +
            "user VARCHAR(100), " +
            "file BLOB);";
    private static String query = "INSERT INTO bicycles (user, file) VALUES (?, ?)";

    public static void load() throws SQLException, FileNotFoundException {
        Connection connection = DriverManager.getConnection("jdbc:mysql://localhost/forjava?user=root&password=");
        PreparedStatement preparedStatement = connection.prepareStatement(createTable);
        preparedStatement.execute();

        File file = new File("D:\\projects\\Bicycles&Wheels\\src\\main\\java\\files\\comments.txt");
        FileInputStream fileInputStream = new FileInputStream(file);
        int length = (int) file.length();

        preparedStatement = connection.prepareStatement(query);
        preparedStatement.setString(1, "user");
        preparedStatement.setBinaryStream(2, fileInputStream, length);
        preparedStatement.execute();

        connection.close();
    }
}
